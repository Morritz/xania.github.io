(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const le="modulepreload",ae=function(e){return"/"+e},V={},T=function(t,n,r){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=ae(o),o in V)return;V[o]=!0;const i=o.endsWith(".css"),c=i?'[rel="stylesheet"]':"";if(!!r)for(let h=s.length-1;h>=0;h--){const d=s[h];if(d.href===o&&(!i||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":le,i||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),i)return new Promise((h,d)=>{u.addEventListener("load",h),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};var te=(e=>(e[e.Attribute=9384756781]="Attribute",e[e.Init=9384756782]="Init",e))(te||{});function he(e){return e&&(e.type===9384756781||e.type===9384756782)}class X{constructor(t){if(this.child=t,!t.parentElement)throw Error("invalid operation");this.container=t.parentElement}appendChild(t){this.container.insertBefore(t,this.child)}addEventListener(t,n,r){this.container.addEventListener(t,n,r)}removeEventListener(t,n,r){this.container.removeEventListener(t,n,r)}insertBefore(t,n){return this.container.insertBefore(t,n)}}function ne(e){return e&&e.render instanceof Function}function _(e,...t){const n=[],r=[e];for(;r.length;){const s=r.pop();if(s instanceof Array)for(let o=s.length-1;o>=0;o--)r.push(s[o]);else s instanceof Function?r.push(s(...t)):s&&n.push(s)}return n}var a=(e=>(e[e.PushFirstChild=693571]="PushFirstChild",e[e.PushNextSibling=693572]="PushNextSibling",e[e.PushChild=693573]="PushChild",e[e.PopNode=693574]="PopNode",e[e.SetAttribute=693575]="SetAttribute",e[e.SetClassName=693576]="SetClassName",e[e.SetTextContent=693577]="SetTextContent",e[e.Renderable=693578]="Renderable",e[e.Attachable=693579]="Attachable",e[e.Subscribable=693580]="Subscribable",e[e.AppendChild=693581]="AppendChild",e[e.Lazy=693582]="Lazy",e[e.Clone=693583]="Clone",e[e.AppendText=693584]="AppendText",e))(a||{}),p=(e=>(e[e.Property=353461]="Property",e[e.Function=353462]="Function",e[e.Observable=353463]="Observable",e[e.Bind=353464]="Bind",e))(p||{});function G(e){return e&&e.type!==null&&e.type!==void 0&&e.type>=353461&&e.type<=353463}function F(e){return e&&e.subscribe instanceof Function}const B=Symbol();function D(e,t){const n=e[B];if(n){let r=n.length;for(;r--;)n[r].next(t)}}class ee{constructor(t){this.value=t}select(t){return D(this,[t,this.value]),()=>{D(this,[t,null])}}lazy(t){const n=this;return(n[B]??(n[B]=[])).push(t),{unsubscribe:()=>{const s=this[B];if(s){const o=s.indexOf(t);o>=0&&s.splice(o,1)}}}}attach(t){const n=this;return{attachTo(s){return n.lazy({next([o,i]){if(i===null)return;const c=o.rootElement;c&&c.contains(s)&&t(s)}})}}}}var $=(e=>(e[e.Tag=8585231]="Tag",e[e.Text=8585232]="Text",e[e.Anchor=8585233]="Anchor",e))($||{});function ue(e){return e?e.type===8585231||e.type===8585232||e.type===8585233:!1}function de(e){return{type:8585231,name:e,classList:[],childNodes:[],attrs:{}}}function M(e){return{type:8585232,data:e}}function fe(e){return{type:8585233,label:e}}function pe(e,t,n){var r=new be(t,n);return ye(e,r.add).then(s=>r)}class be{constructor(t,n){this.target=t,this.driver=n,this.updateOperations=[],this.renderOperations=[],this.lazyOperations=[],this.events=[],this.rootCount=0,this.add=r=>{if(r instanceof O){const s=this.rootCount++;for(const u of r.events)this.events.push([u,s]);const{contentOps:o}=r,{target:i,driver:c}=this,l={type:a.Clone,clone(){return c.appendTag(i,r.templateNode)}};this.renderOperations.push(l);for(let u=0,h=o.length;u<h;u++){const d=o[u];if(this.renderOperations.push(d),d.type===a.SetTextContent){const b=d.expression;b.type===p.Property&&!b.readonly&&this.updateOperations.push(d)}d.type===a.SetClassName&&d.expression.type===p.Function&&this.updateOperations.push(d),d.type===a.Lazy&&this.lazyOperations.push(d)}}else F(r)?this.addAnchoredOperation({type:a.Subscribable,observable:r}):ne(r)?this.addAnchoredOperation({type:a.Renderable,renderable:r}):r!=null?this.renderOperations.push({type:a.AppendText,value:r}):console.error("Not supported",r)}}addAnchoredOperation(t){const n=this.driver.appendAnchor(this.target,"-- root anchor --");q(this.renderOperations,n),this.renderOperations.push(t,{type:a.PopNode,index:n}),this.rootCount++}ssr(){return"console.log('compile result');"}}async function ye(e,t){const n=[],r=[e];for(;r.length;){const s=r.pop();if(s instanceof Array)for(let o=s.length-1;o>=0;o--)r.push(s[o]);else s instanceof Promise?r.push(await s):s&&n.push(t(s))}return n}class me{constructor(){}appendAnchor(t,n){if(t instanceof X)throw new Error("not supported!");{const r=t.childNodes.length,s=document.createComment(n);return t.appendChild(s),r}}appendTag(t,n){const r=se(n);return t.appendChild(r),r}}function se(e){const t=document.createElement(e.name);for(const n of e.classList)t.classList.add(n);for(const n in e.attrs)t[n]=e.attrs[n];for(const n of e.childNodes)switch(n.type){case $.Tag:t.appendChild(se(n));break;case $.Text:const r=document.createTextNode(n.data);t.appendChild(r);break;case $.Anchor:const s=document.createComment("anchor: "+n.label);t.appendChild(s);break;default:console.error("not supported",n);break}return t}const re=Symbol();function oe(e,t,n,r){let s={head:r,length:0};for(let o=0,i=t.length|0,c=e.length|0;o<i;o++){const l=t[o];for(let u=0;u<c;u++){const h=e[u];switch(h.type){case a.AppendText:s.head.appendChild(document.createTextNode(h.value));break;case a.Lazy:l[h.nodeKey]=s.head;break;case a.Clone:const d=h.clone();if(d[re]=l,l.rootElement){const{moreRootElements:f}=l;f?f.push(d):l.moreRootElements=[d]}else l.rootElement=d;s.head=d,s[0]=d,s.length=1;break;case a.PushFirstChild:let b=s.head.firstChild;s[s.length]=b,s.head=b,s.length++;break;case a.PushNextSibling:let y=s.head.nextSibling;for(let f=1;f<h.offset;f++)y=y.nextSibling;s[s.length-1]=y,s.head=y;break;case a.PushChild:let N=s.head.firstChild;for(let f=0;f<h.index;f++)N=N.nextSibling;s[s.length]=N,s.head=N,s.length++;break;case a.PopNode:if(s.length===0)throw Error("reached end of stack");const K=s.length-1;s.length=K,s.head=s[K-1];break;case a.SetAttribute:const m=h.expression,k=s.head;switch(l[h.nodeKey]=k,m.type){case p.Property:const f=l[m.name];k[h.name]=f;break;case p.Observable:m.observable.subscribe({elt:s.head,name:h.name,next(g){const{elt:x,name:C}=this;x[C]=g}});break}break;case a.SetClassName:const L=h.expression,Y=s.head;l[h.nodeKey]=Y;const U=[];l[h.prevKey]=U;let S;switch(L.type){case p.Property:S=l[L.name];break;case p.Observable:const f=[],g=L.observable.subscribe({prev:f,classes:h.classes,elt:s.head,next(x){const C=x instanceof Function?x(l):x,{prev:z,classes:I,elt:H}=this;for(const P of z)H.classList.remove(P);if(z.length=0,C instanceof Array){const P=[C];for(;P.length;){const A=P.pop();if(A instanceof Array)for(let w=0,ce=A.length;w<ce;w++)P.push(A[w]);else if(A){const w=I?I[A]:A;H.classList.add(w),z.push(w)}}}else{const P=I?I[C]:C;H.classList.add(P),z.push(P)}}});g&&(l.subscriptions?l.subscriptions.push(g):l.subscriptions=[g]);break;case p.Function:S=L.func(l);break;default:console.error("not supported ",L);break}const Z=Y.classList,R=h.classes;if(S instanceof Array)for(let f=0,g=S.length;f<g;f++){const x=S[f],C=R?R[x]:x;Z.add(C),U.push(C)}else if(S){const f=R?R[S]:S;Z.add(f),U.push(f)}break;case a.SetTextContent:const W=h.expression,j=s.head;switch(l[h.nodeKey]=j,W.type){case p.Property:j.textContent=l[W.name]??"";break;case p.Observable:const{observable:f}=W,g=f.subscribe({textNode:s.head,next(x){this.textNode.textContent=x}});g&&(l.subscriptions?l.subscriptions.push(g):l.subscriptions=[g]);break}break;case a.Attachable:h.attachable.attachTo(s.head);break;case a.Renderable:const v=h.renderable.render(new X(s.head),n,{data:l});v&&("dispose"in v&&v.dispose instanceof Function?l.bindings?l.bindings.push(v):l.bindings=[v]:"unsubscribe"in v&&v.unsubscribe instanceof Function&&(l.subscriptions?l.subscriptions.push(v):l.subscriptions=[v]));break;default:console.error("not supported",h);break}}}}function ge(e){if(!e)return;const{bindings:t,subscriptions:n,rootElement:r,moreRootElements:s}=e;if(t){let o=t.length;for(;o--;)t[o].dispose()}if(n){let o=n.length;for(;o--;)n[o].unsubscribe()}if(r&&r.remove(),s){let o=s.length;for(;o--;)s[o].remove()}}function xe(e,t,n){return e.addEventListener(t.name==="blur"?"focusout":t.name,r,!0),{dispose(){e.removeEventListener(t.name,r)}};function r(s){const o=s.target,i=ve(e,o);if(!i)return;const c=i[re];if(i!==Ce(c,n))return;const{nav:l}=t;let u=i;for(let h=0,d=l.length;h<d;h++){const b=l[h];switch(b.type){case a.PushChild:u=u.firstChild;let y=b.index;for(;y--;)u=u.nextSibling;break;default:console.error("not supported",a[b.type]);break}}if(u===o||u.contains(o)){const h={data:c,event:s,node:i};t.handler(h)}}}function ve(e,t){let n=t;const r=e instanceof X?e.container:e;for(;n&&n.parentNode!==r;)n=n.parentNode;return n}function Ce(e,t){return t===0?e.rootElement:t>0&&(e!=null&&e.moreRootElements)?e.moreRootElements[t-1]:null}function Se(e,t){for(let n=0,r=t.length|0,s=e.length|0;n<r;n++){const o=t[n];for(let i=0;i<s;i++){const c=e[i];switch(c.type){case a.SetTextContent:const l=c.expression;switch(l.type){case p.Property:let m=o[l.name],k=o[c.nodeKey];k.textContent=m??"";break}break;case a.SetClassName:const u=c.expression,h=c.classes,d=o[c.nodeKey].classList,b=o[c.prevKey]||[];if(b instanceof Array)for(const m of b)d.remove(m);let y;switch(u.type){case p.Property:y=o[u.name];break;case p.Function:y=u.func(o);break}if(y instanceof Array)for(const m of y){const k=h?h[m]:m;d.add(k),b.push(k)}else if(y){const m=h?h[y]:y;d.add(m),b.push(m)}o[c.prevKey]=b;break;case a.SetAttribute:const N=c.expression,K=o[c.nodeKey];switch(N.type){case p.Property:const m=o[N.name];K[c.name]=m;break}break;default:console.error(c);break}}}}function J(e,t,n=new me){if(e==null)return e;if(e instanceof Promise)return e.then(r=>J(r,t));{const r={};return pe(e,t,n).then(s=>{const{renderOperations:o,events:i}=s;oe(o,[r],n),Pe(s.lazyOperations);for(const[c,l]of i)xe(t,c,l);return{dispose(){ge(r)}}})}}function Pe(e,t){for(const n of e)n.lazy.lazy({next([r,s]){r&&(r[n.valueKey]=s,Se([n.operation],[r]))}})}function Ne(e){new Date().getTime().toString();const{contentOps:t,templateNode:n}=this;try{oe(t,[{}],new ke(n))}catch(r){console.log(r)}}class ke{constructor(t){this.template=t}}class O{constructor(t){this.name=t,this.contentOps=[],this.events=[],this.hibernate=Ne,this.templateNode=de(t)}setProp(t,n,r){if(n==null)return;if(n instanceof Promise)return n.then(o=>this.setProp(t,o,r));const{templateNode:s}=this;if(n instanceof Function)this.events.push({name:t,handler:n,nav:[]});else if(t==="class")for(const o of _(n))if(typeof o=="string"){const i=r==null?void 0:r.classes;for(const c of o.split(" "))c&&s.classList.push(i&&i[c]||c)}else if(o instanceof ee){const i=Symbol("value"),c=Symbol("node");this.contentOps.push({type:a.Lazy,nodeKey:c,valueKey:i,lazy:o,operation:{prevKey:Symbol("prev"),type:a.SetClassName,expression:{type:p.Property,name:i,readonly:!0},classes:r==null?void 0:r.classes,nodeKey:c}})}else{const i=Ae(o);i&&this.contentOps.push({prevKey:Symbol("prev"),nodeKey:Symbol("node"),type:a.SetClassName,expression:i,classes:r==null?void 0:r.classes})}else if(n instanceof ee){const o=Symbol("value"),i=Symbol("node");this.contentOps.push({type:a.Lazy,nodeKey:i,valueKey:o,lazy:n,operation:{nodeKey:i,type:a.SetAttribute,expression:{type:p.Property,name:o,readonly:!0},name:t}})}else F(n)?this.contentOps.push({nodeKey:Symbol("node"),type:a.SetAttribute,name:t,expression:{type:p.Observable,observable:n}}):G(n)?this.contentOps.push({nodeKey:Symbol("node"),type:a.SetAttribute,name:t,expression:n}):s.attrs[t]=n}appendContent(t){if(!(t instanceof Array))return;const{templateNode:n,contentOps:r}=this;function s(o){const i={key:Symbol(),nodeKey:Symbol(),type:a.SetTextContent,expression:o};if(n.childNodes.length===0)for(let u=r.length-1;u>=0;u--){const h=r[u];if(h.type===a.SetTextContent){const d=M("");n.childNodes.push(d);const b={type:a.PushFirstChild},y={type:a.PopNode,index:0};r.splice(u,1,b,h,y)}}const c=n.childNodes.length;c===0?r.push(i):l();function l(){const u=M("");n.childNodes.push(u),q(r,c),r.push(i),r.push({type:a.PopNode,index:c})}}for(let o=0;o<t.length;o++){const i=t[o];if(i instanceof O)this.appendElement(i);else if(i instanceof Promise){const c=t.slice(o+1);return i.then(l=>{this.appendContent([l,...c])})}else if(F(i))s({type:p.Observable,observable:i});else if(i.attachTo instanceof Function)r.push({type:a.Attachable,attachable:i});else if(ne(i)){const c=n.childNodes.length;q(r,c);const l=fe("renderable");n.childNodes.push(l),r.push({type:a.Renderable,renderable:i},{type:a.PopNode,index:c})}else if(G(i))s(i);else if(ue(i))n.childNodes.push(i);else if(he(i))switch(i.type){case te.Attribute:const c=this.setProp(i.name,i.value,i.options);if(c instanceof Promise){const l=t.slice(o+1);return c.then(()=>{this.appendContent(l)})}break}else n.childNodes.push(M(i))}}appendElement(t){const{templateNode:n,contentOps:r}=this,s=n.childNodes.length;if(t.contentOps.length>0){q(r,s);for(let o=0;o<t.contentOps.length;o++)this.contentOps.push(t.contentOps[o]);this.contentOps.push({type:a.PopNode,index:s})}for(const o of t.events)this.events.push({name:o.name,nav:[{type:a.PushChild,index:s},...o.nav],handler:o.handler});this.templateNode.childNodes.push(t.templateNode)}}function q(e,t){if(t===0){e.push({type:a.PushFirstChild});return}const n=e.length;if(n>2){const r=e[n-1];if(r.type===a.PopNode){const s=r.index;e.pop(),e.push({type:a.PushNextSibling,offset:t-s});return}}e.push({type:a.PushChild,index:t})}function Ae(e){return e instanceof Function?null:F(e)?{type:p.Observable,observable:e}:G(e)?e:null}function we(e){return{createElement(t,n=null,...r){if(t instanceof Function){let c=r instanceof Array&&r.length>0?n==null?{children:r}:{...n,children:r}:n;try{return t(c,e)}catch(l){if(t.toString().startsWith("class"))return Reflect.construct(t,c);throw l}}const s=[],o=new O(t);if(n)for(const c in n){const l=n[c],u=o.setProp(c,l,e);u instanceof Promise&&s.push(u)}const i=_(o.appendContent(_(r)));for(const c of i)c instanceof Promise&&s.push(c);return s.length>0?Promise.all(s).then(()=>o):o},createFragment(t){return _(t==null?void 0:t.children)}}}function ie(e){const t=[e];for(;t.length>0;){const n=t.pop();if(n)if(n instanceof Array)for(const r of n)t.push(r);else n instanceof Promise?n.then(ie):(n==null?void 0:n.dispose)instanceof Function&&n.dispose()}}function Q(e){if(e instanceof O)return e;if(e instanceof Promise)return{render(t,n){return e.then(r=>J(Q(r),t,n))}};if(F(e))return{observable:e,render(t){return e.subscribe({bindings:null,next(r){const{bindings:s}=this;s&&ie(s),this.bindings=J(r,t)}})}};console.log("\x1B["+31+"mnot yet supported\x1B[0m"),console.error(e)}const E=we();function Ee(){return location.pathname==="/state"||location.pathname==="/packages/state"?T(()=>import("./App-e26a0fb5.js"),["assets/App-e26a0fb5.js","assets/App-fe3e777f.css"]).then(e=>Q(E.createElement(e.App,null))):location.pathname==="/view"?T(()=>import("./App-8bc4d273.js"),[]).then(e=>Q(E.createElement(e.App,null))):E.createElement("div",null,E.createElement("a",{href:"/view"},"View"),E.createElement("a",{href:"/state"},"State"))}J(E.createElement(Ee,null),document.getElementById("app"));export{O as J,$ as T,E as a,ue as i,we as j};
